<%= @exhibit.name %><br>
<% @exhibit.tags.each do |tag| %>
  <p><%= link_to "##{tag.name}", tag %></p>
<% end %>
<%= @exhibit.description %>
<p>
  <%=@exhibit.start_date.strftime("%B, %d")%> - <%= @exhibit.end_date.strftime("%B, %d %Y") %>
</p>
<%= link_to "Currently at #{@museum.name}", @museum %>
<br><br>
<%= image_tag @exhibit.photo.url(:large) %>
<%= form_for @ticket, remote: true do |f| %>
  <div class="input-group">
    <div class="input-group-btn">
      <%= f.hidden_field :quantity, value: 1%>
      <%= f.hidden_field :museum_id, value: @exhibit.museum_id %>
      <%= f.hidden_field :exhibit_id, value: @exhibit.id %>
      <%= f.hidden_field :user_id, value: current_user.id %>
      <%= f.submit "Add to Cart", class: "btn btn-primary" %>
    </div>
  </div>
<% end %>

<div id="map">

<% if admin? %>
  <%= link_to "Add Exhibit Tags", "#{@exhibit.id}/tagging" %>
  <%= link_to "Edit Exhibit", edit_exhibit_path %>
<% end %>

<script type="text/javascript">
  function buildMap(){
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(12);
    });
  }
  $(window).onload(buildMap())
</script>
